from datasets import load_dataset
from transformers import AutoTokenizer, GPTNeoForSequenceClassification
from transformers import AutoTokenizer

# Load dataset
dataset = load_dataset("yelp_review_full")
print('dataset record example:', dataset["train"][1]) 


# Create tokenizer 
tokenizer = AutoTokenizer.from_pretrained("bert-base-cased")


def tokenize_function(examples):
    return tokenizer(examples["text"], padding="max_length", truncation=True)

tokenized_datasets = dataset.map(tokenize_function, batched=True)

# Data precessing
tokenized_datasets = tokenized_datasets.remove_columns(["text"])
tokenized_datasets = tokenized_datasets.rename_column("label", "labels")
tokenized_datasets.set_format("torch")

small_train_dataset = tokenized_datasets["train"].shuffle(seed=42).select(range(1000))
small_eval_dataset = tokenized_datasets["test"].shuffle(seed=42).select(range(1000))

